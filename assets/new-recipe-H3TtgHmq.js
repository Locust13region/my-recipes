import{A as V,b as $,u as _,a as H,w as c,r as i,D as K,E as G,j as t,L as J,C as P,c as l,F as q,G as y,H as z,M as Q,I as X,J as Y,K as Z}from"./index-NQcnBVEJ.js";import{C as ee}from"./Container--g_0yjYT.js";import{B as te}from"./Box-bRcen-H5.js";import{M as ae}from"./MenuItem-DjKhSq1N.js";const se=X(),ce=()=>{const p=V(),m=Number(p.categoryId),g=$(),r=_(),T=H(),I=c(e=>e.userState.user.accessToken),w=c(e=>e.recipesState.categories),k=c(e=>e.recipesState.tags);i.useEffect(()=>{r(K()),r(G())},[I,r]);const[D,E]=i.useState(m),[o,x]=i.useState(""),[h,f]=i.useState(""),F=e=>{f(""),x(e.target.value)},[v,j]=i.useState(""),W=e=>{j(e.target.value)},[b,S]=i.useState(""),A=e=>{S(e.target.value)},[u,N]=i.useState([]),M=e=>{const s=e.target.value.split(`
`).map(n=>({name:n}));N(s)},[d,R]=i.useState([]),O=e=>{const s=e.target.value.split(`
`).map(n=>({text:n}));R(s)},U=async()=>{if(!o){f("Необходимо название рецепта");return}r(Y({categoryId:m,name:o,description:b,source:v,steps:d,ingredients:u})).then(({payload:s})=>{C(),T(`/${s.categoryId}/${s.id}`,{replace:!0})})},C=()=>{r(Z(null)),x(""),j(""),S(""),N([]),R([])};return t.jsxs("div",{className:"flex flex-col mx-auto max-w-md min-h-screen border",children:[t.jsxs("header",{className:"header-footer-link top-0",children:[t.jsx(J,{to:`/${p.categoryId}`,className:"flex grow",children:t.jsx("span",{className:" text-amber-500 text-3xl material-symbols-outlined",children:"arrow_back"})}),t.jsx("h2",{className:"leading-3 text-xl",children:"Новый рецепт"})]}),t.jsxs(ee,{component:"main",className:"bg-link grow relative overflow-y-scroll",children:[t.jsx(P,{}),t.jsxs(te,{component:"form",noValidate:!0,autoComplete:"off",display:"flex",flexDirection:"column",alignItems:"center",children:[t.jsx(l,{type:"search",fullWidth:!0,autoFocus:!0,id:"recipeTitle",name:"recipeTitle",variant:"standard",label:"Название",value:o,error:!!h,helperText:h,onChange:F,sx:{mt:1}}),t.jsx(l,{select:!0,fullWidth:!0,id:"selectedCategory",name:"selectedCategory",variant:"standard",label:"Категория",value:D,disabled:g.pathname.includes("new"),onChange:e=>{E(Number(e.target.value))},sx:{mt:1},children:w.map(e=>t.jsx(ae,{value:e.id,children:e.name},e.id))}),t.jsx(q,{freeSolo:!0,id:"selectedTag",fullWidth:!0,autoFocus:!0,selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,value:c(e=>e.recipesState.selectedTagValue),onChange:(e,a)=>{typeof a=="string"?r(y(a)):a&&a.inputValue?r(y(a.inputValue)):r(z(a))},filterOptions:(e,a)=>{const s=se(e,a),{inputValue:n}=a,B=e.some(L=>n===L.name);return n!==""&&!B&&s.push({inputValue:n,name:`Добавляем "${n}"`}),s},options:k,getOptionLabel:e=>typeof e=="string"?e:e.inputValue?e.inputValue:e.name,renderInput:e=>t.jsx(l,{...e,name:"selectedTag",label:"#хештег",variant:"standard"})}),t.jsx(l,{type:"search",fullWidth:!0,id:"recipeUrl",name:"recipeUrl",variant:"standard",label:"Ссылка на первоисточник",value:v,onChange:W,sx:{mt:1}}),t.jsx(l,{multiline:!0,fullWidth:!0,id:"recipeDescription",name:"recipeDescription",variant:"standard",label:"Описание рецепта",value:b,onChange:A,sx:{mt:1}}),t.jsx(l,{multiline:!0,fullWidth:!0,id:"recipeIngredients",name:"recipeIngredients",variant:"standard",label:"Ингредиенты",value:u&&u.map(e=>e.name).join(`
`),onChange:M,sx:{mt:1}}),t.jsx(l,{multiline:!0,fullWidth:!0,id:"recipeSteps",name:"recipeSteps",variant:"standard",label:"Этапы приготовления",value:d&&d.map(e=>e.text).join(`
`),onChange:O,sx:{mt:1}})]})]}),t.jsxs("footer",{className:"header-footer-link bottom-0",children:[t.jsx("button",{className:"leading-3  text-xl",onClick:()=>{U()},children:"Сохранить"}),t.jsx("button",{className:"",onClick:()=>{g.pathname.includes("new")?C():console.log("delete")},children:t.jsx("span",{className:"flex text-amber-500 text-3xl material-symbols-outlined",children:"layers_clear"})})]}),t.jsx(Q,{})]})};export{ce as default};
